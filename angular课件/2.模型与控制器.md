# MVVM简介
针对客户端应用开发AngularJS吸收了传统的MVC基本原则。MVC(Model-View-Controll)设计模式针对不同的人可能意味不同的东西 ,AngularJS并不执行传统意义上的MVC，更接近于MVVM。

MVVM模式是Model-View-ViewMode模式的简称。由视图(View)、视图模型(ViewModel)、模型(Model)三部分组成，通过这三部分实现UI逻辑、呈现逻辑和状态控制、数据与业务逻辑的分离。

Model将和ViewModel互动(通过$scope对象)，将监听Model的变化。这些可以通过View来发送和渲染，由HTML来展示你的 代码。View可以通过$routeProvider对象来支配，所以你可以深度的链接和组织你的View和Controller，将他们变成导航 URL。AngualrJS同时提供了无状态的Controller，可以用来初始化和控制$scope对象。

Model与MVC模式一样，Model用于封装与应用程序的业务逻辑相关的数据以及对数据的处理方法。它具有对数据直接访问的权利，例如对数据库的访问，Model不依赖于View和ViewModel，也就是说，模型不关心会被如何显示或是如何被操作，模型也不能包含任何用户使用的与界面相关的逻辑。

ViewModel是一个用来提供特别数据和方法从而维护指定view的对象,。ViewModel是$scope的对象，只存在于AnguarJS的应用中。$scope只是一个简单的js对象，这个对象使用简单的API来侦测和广播状态变化。

Controller负责设置初始状态和参数化$scope方法用以控制行为。需要指出的controller并不保存状态也不和远程服务互动。

View是AngularJS解析后渲染和绑定后生成的HTML。这个部分帮助你创建web应用的架构。$scope拥有一个针对数据的参考，controller定义行为，view处理布局和互动。

使用MVVM模式有几大好处：

1. 低耦合：View可以独立于Model变化和修改，一个ViewModel可以绑定到不同的View上，当View变化的时候Model可以不变，当Model变化的时候View也可以不变。

2. 可重用性：可以把一些视图的逻辑放在ViewModel里面，让很多View重用这段视图逻辑。

3. 独立开发：开发人员可以专注与业务逻辑和数据的开发(ViewModel)。设计人员可以专注于界面(View)的设计。

4. 可测试性：可以针对ViewModel来对界面(View)进行测试。


## 控制器
AngularJS控制器控制AngularJS应用程序的数据，是常规的JavaScript对象。

ng-controller指令就是用来定义应用程序控制器的，并且同时创建了一个新的作用域关联到相应的DOM元素上。

所谓作用域就是一个指向应用模型的对象，它是表达式的执行环境，作用域有层次结构，这个层次和相应的DOM几乎是一样的，作用域能监控表达式和传递事件并且可以从父作用域继承属性。

每一个AngularJS应用都有一个绝对的根作用域。但也可能有多个子作用域。 一个应用可以有多个作用域，因为有一些指令会生成新的子作用域，当新作用域被创建的时候，他们会被当成子作用域添加到父作用域下，这使得作用域会变成一个和相应DOM结构一个的树状结构。

```
<body>
	<div ng-controller="parentCtrl">
        <p><input type="text" ng-model="show" /></p>
        <div>{{show}}</div>
    </div>
    <script>
	    function parentCtrl($scope){
	    	$scope.show="你好吗？"
	    }
    </script>
</body>
```

如上所述，我们通过ng-controller指令创建了一个JavaScript对象 ——  parentCtrl并带有name属性，那参数$scope是什么呢，代表什么意思呢。
## $scope
现在我们就来解答 parentCtrl对象参数 —— $scope。





$scope就是把一个DOM元素连结到控制器上的对象，它提供一个绑定到DOM元素上的执行上下文。

scope被放置于一个类似应用的DOM结构的层次结构中

要明确创建一个$scope对象，我们就要给DOM元素安上一个controller对象，使用的是ng-controller 指令属性。

所有$scope都遵循原型继承，这意味着它们都能访问父$scope们,对任何属性和方法，如果AngularJS在当前$scope上找不到，就会到父$scope上去找，如果在父$scope上也没找到，就会继续向上回溯，一直到$rootScope上，这个$rootScope是最顶级的$scope，它对应着含有 ng-app指令属性的那个DOM元素，也就是说根作用域关联的DOM就是ng-app指令定义的地方。

也就是说，拥有了$scope，我们就可以操作作用域内任何我们想要获取的对象数据。
> scope提供$watch API,用于监测model的变化。

> scope提供$apply，在"Angular realm"（controller、server、angular event handler）之外，从系统到视图传播任何model的变化。

> scope可以在提供到被共享的model属性的访问的时候，被嵌入到独立的应用组件中。scope通过（原型），从parent scope中继承属性。

```
<div ng-controller="parentCtrl">
	<p><input type="text" ng-model="show" /></p>
	<div ng-controller="sonCtrl">
	    <input type="text" ng-model="show" />
	    {{money}}
	 </div>
	<div>{{show}}</div>
</div>
    <script>
	    function parentCtrl($scope){
	    	$scope.show="你好吗？"
	    	$scope.money=2000;
	    }
	    function sonCtrl($scope){
	    	$scope.show="very good"
	    }
    </script>
```

### 控制器方法

控制器不仅声明属性也可以声明方法，如下所示：
```
<div ng-app="" ng-controller="MyController">
     Your name:
     <input type="text" ng-model="username">
     <button ng-click="sayHello()">打招呼</button>
     <hr />
     {{greeting}}
</div>

<script>
function MyController($scope) {
  $scope.username = 'World';
  $scope.sayHello = function() {
    $scope.greeting= 'Hello ' + $scope.username + '!';
  };
}
</script>
```


当然如果是开发条件的需要，我们也可以将控制器写在外部文件中，那如上示例该怎么做呢，很简单，如下简单引用即可：
```
<script src="MyController.js"></script>
```
## 案例 计算器
```html
<h1>计算器</h1>
<div ng-controller="calcCtrl">
	<input type="text" ng-model="pre"/>+<input type="text" ng-model="next"/>=<input type="text" value="{{pre*1+next*1}}"/>
	<p>两数相乘:{{pre*next}}</p>
	<p>两数相除:{{pre/next}}</p>
	<p>两数相减:{{pre-next}}</p>
</div>
<script>
   function calcCtrl($scope){
   		$scope.pre=0;
   		$scope.next=0;
   }
</script>
```

# Module
### 什么是Module
大部分应用都有一个主方法(main)用来实例化、组织、启动应用。  
AngularJS应用没有主方法，而是使用模块来声明应用应该如何启动。  
模块允许通过声明的方式来描述应用中的依赖关系，以及如何进行组装和启动

## Angular 模块

模块是组织业务的一个框框，在一个模块当中定义多个服务。当引入了一个模块的时候，就可以使用这个模块提供的一种或多种服务了。
AngularJS 本身的一个默认模块叫做 ng ，它提供了 $http ， $scope等等服务 

服务只是模块提供的多种机制中的一种，其它的还有指令（ directive ），过滤器（ filter ），及其它配置信息。

也可以在已有的模块中新定义一个服务，也可以先新定义一个模块，然后在新模块中定义新服务。

服务是需要显式地的声明依赖（引入）关系的，让 ng 自动地做注入

## Module优点
- 启动过程是声明式的，更容易懂。
- 在单元测试是不需要加载全部模块的，因此这种方式有助于写单元测试。
- 可以在特定情况的测试中增加额外的模块，这些模块能更改配置，能帮助进行端对端的测试。
- 第三方代码可以作为可复用的module打包到angular中
- 模块可以以任何先后或者并行的顺序加载（因为模块的执行本身是延迟的）。

## ng-app
通过ng-app指定对应的模块应用启动
```
angular.module(name[, requires], configFn);
configFn 会在模块初始化时执行，可以在里配置模块的服务
```
html 部分
```
<!DOCTYPE html>
<html ng-app="myapp">
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="script/angular.min.js"></script>
		<script src="script/myModule.js"></script>
	</head>
	<body>
		<h1>Module</h1>
		<div ng-controller="myCtrl">
			<input type="text" ng-model="show"/>
			<p>{{show}}</p>
		</div>
	</body>
</html>
```

myModule.js模块部分
```
angular.module("myapp",[])
.controller("myCtrl",function($scope){
	$scope.show="my play";
})
```



