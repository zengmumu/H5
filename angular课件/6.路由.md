# 内置路由

step 1 
```
<script src="script/angular-route.min2.js"></script>
```
step 2
```
<div class="nav">
    <a href="#/">首页</a>
    <a href="#/book/">图书</a>
    <a href="#/game/">游戏</a>
</div>
<div ng-view>
	
</div>

```
step 3
```
angular.module("myapp",["ngRoute","booklist","detail"])
.config(function($routeProvider){
	$routeProvider
	.when("/",{templateUrl:"tpl/booklist.html"})
	.when("/book/",{templateUrl:"tpl/booklist.html"})
	.when("/game/",{templateUrl:"tpl/gamelist.html"})
	.when("/view/:id",{templateUrl:"tpl/detail.html"})
	.otherwise({
		redirectTo:"/"
	})
})
.controller("mainCtrl",["$scope",function($scope){
	$scope.aNum=0;
	$scope.navData=[{name:"首页",url:"#/"},{name:"图书",url:"#/book/"},{name:"游戏",url:"#/game/"}];
	$scope.setNum=function(num){
		$scope.aNum=num;
	}
	
	}])
```
```
angular.module("detail",[])//定义一个detail模块
.controller("detailCtrl",["$scope","$http","$routeParams","$sce",function($scope,$http,$routeParams,$sce){
	//需要什么服务获取什么服务
	//$scope 作用域
	//$routeParams 获取路由传的参数
	//$sce 安全处理的服务
	
	$http.get("http://127.0.0.1/article.php?id="+$routeParams.id)
	.success(function(res){//当ajax 成功适合
		$scope.detailData=res.data;//scope.detailData赋值为获取值的data
	})
	$scope.getTrustHtml=function(data){
		return $sce.trustAsHtml(data);//返回安全处理的的html数据
	}
	
}])

```

---
# ui router
如何引用依赖angular-ui-router
```
angular.module('app',["ui.router"])
.config(function($stateProvider){
$stateProvider.state(stateName, stateCofig);
})

```
# $stateProvider.state(stateName, stateConfig)
```
stateName是         string类型
stateConfig是       object类型
//statConfig        可以为空对象
$stateProvider.state("home",{});

//state可以有子父级
$stateProvider.state("home",{});
$stateProvider.state("home.child",{})

//state可以是链式的
$stateProvider.state("home",{}).state("about",{}).state("photos",{});

stateConfig包含的字段：template, templateUrl, templateProvider, controller, controllerProvider, resolve, url, params, views, abstract, onEnter, onExit, reloadOnSearch, data


```
#  $urlRouteProvider
```
$urlRouteProvider.when(whenPath, toPath)
$urlRouterProvider.otherwise(path)
$urlRouteProvider.rule(handler)
```
# $state.go
$state.go(to, [,toParams],[,options])
```
形参to是string类型，必须，使用"^"或"."表示相对路径；
形参toParams可空，类型是对象；
形参options可空，类型是对象，字段包括：location为bool类型默认true,inherit为bool类型默认true, relative为对象默认$state.$current,notify为bool类型默认为true, reload为bool类型默认为false
$state.go('photos.detail')
$state.go('^')到上一级,比如从photo.detail到photo
$state.go('^.list')到相邻state,比如从photo.detail到photo.list
$state.go('^.detail.comment')到孙子级state，比如从photo.detail到photo.detial.comment
```
# ui-sref
```
ui-sref='stateName'
ui-sref='stateName({param:value, param:value})'
```
# ui-view
==没有名称的ui-view==

```
<div ui-view></div>
$stateProvider.state("home",{
    template: "<h1>hi</h1>"
})
```
或者这样配置：
```
$stateProvider.state("home"{
    views: {
        "": {
        template: "<h1>hi</h1>"
        }
    }
})
```
### 有名称的ui-view
```
<div ui-view="main"></div>
$stateProvider.state("home",{
    views: {
        "main" : {
        template: "<h1>hi</h1>"
        }
    }
})
```

### 多个ui-view
```
<div ui-view></div>
<div ui-view="data"></div>
$stateProvider.state("home",{
    views: {
    "":{template: "<h1>hi</h1>"},
    "data": {template: "<div>data</div>"}
    }
})
```

### 多个view以及state嵌套

有时候，一个页面上可能有多个ui-view，比如：

```
<div ui-view="header"></div>
<div ui-view="body"></div>
```
假设，以上页面属于一个名称为parent的state中。
我们知道在ui-router中，一个state大致是这样设置的：
```
<div ui-view="header"></div>
<div ui-view="body"></div>
```
所有state下views下的所有键值对(类似 "body@content":{templateUrl: 'partials/photos.html'})都被放到一个键值集合中。而ui-view的工作原理就是根据自己的属性值，到这个键值集合中去找匹配的键，找到就把对应的页面显示出来。

点击header对应的页面链接，可能会跳转到另外的子页面出现在
```
<div ui-view="body"></div>
```
这个位置。

这时候页面出现了子父关系，而每个页面都属于某个state,这样state间就出现了子父关系。这些跳转的子页面，在路由设置中，可能被称为parent.son1, parent.son2...这就是state的嵌套。

在现有的文件结构上增加content.html, header.html,文件结构变为：
```
node_modules/
partials/
.....about.html
.....home.html
.....photos.html
.....content.html
.....header.html
app.js
index.html
```
content.html 包含了多各ui-view, 一个ui-view和页头相关，保持不变；令一个ui-view和会根据页头上的点击呈现不同的内容
```
<div ui-view="header"></div>
<div ui-view="body"></div>
```
```
routerApp.config(function($stateProvider, $urlRouterProvider) {
    $urlRouterProvider.otherwise('/index');
    $stateProvider
        .state('index', {
            url: '/index',
            views: {
                '': {
                    templateUrl: 'tpls/home.html'
                },
                'main@index': {
                    templateUrl: 'tpls/loginForm.html'
                }
            }
        })
        .state('booklist', {
            url: '/{bookType:[0-9]{1,4}}',
            views: { //注意这里的写法，当一个页面上带有多个ui-view的时候如何进行命名和视图模板的加载动作
                '': {
                    templateUrl: 'tpls/bookList.html'
                },
                'booktype@booklist': {
                    templateUrl: 'tpls/bookType.html'
                },
                'bookgrid@booklist': {
                    templateUrl: 'tpls/bookGrid.html'
                }
            }
        })
        .state('addbook', {
            url: '/addbook',
            templateUrl: 'tpls/addBookForm.html'
        })
        .state('bookdetail', {
            url: '/bookdetail/:bookId', //注意这里在路由中传参数的方式
            templateUrl: 'tpls/bookDetail.html'
        })
});
```